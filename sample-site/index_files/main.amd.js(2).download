!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("cookie-utils"),require("Localizer"),require("jquery")):"function"==typeof define&&define.amd?define(["cookie-utils","Localizer","jquery"],t):"object"==typeof exports?exports["thd-targeted-merchandise"]=t(require("cookie-utils"),require("Localizer"),require("jquery")):e["thd-targeted-merchandise"]=t(e["cookie-utils"],e.Localizer,e.jquery)}("undefined"!=typeof self?self:this,function(e,t,n){return function(e){function t(e){delete installedChunks[e]}function n(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("script");n.type="text/javascript",n.charset="utf-8",n.src=f.p+""+e+"."+b+".hot-update.js",t.appendChild(n)}function r(e){return e=e||1e4,new Promise(function(t,n){if("undefined"==typeof XMLHttpRequest)return n(Error("No browser support"));try{var r=new XMLHttpRequest,o=f.p+""+b+".hot-update.json";r.open("GET",o,!0),r.timeout=e,r.send(null)}catch(e){return n(e)}r.onreadystatechange=function(){if(4===r.readyState)if(0===r.status)n(Error("Manifest request to "+o+" timed out."));else if(404===r.status)t();else if(200!==r.status&&304!==r.status)n(Error("Manifest request to "+o+" failed."));else{try{var e=JSON.parse(r.responseText)}catch(e){return void n(e)}t(e)}}})}function o(e){var t=k[e];if(!t)return f;var n=function(n){return t.hot.active?(k[n]?0>k[n].parents.indexOf(e)&&k[n].parents.push(e):(w=[e],m=n),0>t.children.indexOf(n)&&t.children.push(n)):(console.warn("[HMR] unexpected require("+n+") from disposed module "+e),w=[]),f(n)};for(var r in f)Object.prototype.hasOwnProperty.call(f,r)&&"e"!==r&&Object.defineProperty(n,r,function(e){return{configurable:!0,enumerable:!0,get:function(){return f[e]},set:function(t){f[e]=t}}}(r));return n.e=function(e){function t(){T--,"prepare"===H&&(S[e]||u(e),0===T&&0===E&&l())}return"ready"===H&&a("prepare"),T++,f.e(e).then(t,function(e){throw t(),e})},n}function i(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:m!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var r=0;e.length>r;r++)t._acceptedDependencies[e[r]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;e.length>n;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);0>n||t._disposeHandlers.splice(n,1)},check:d,apply:p,status:function(e){if(!e)return H;x.push(e)},addStatusHandler:function(e){x.push(e)},removeStatusHandler:function(e){var t=x.indexOf(e);0>t||x.splice(t,1)},data:O[e]};return m=void 0,t}function a(e){H=e;for(var t=0;x.length>t;t++)x[t].call(null,e)}function c(e){return+e+""===e?+e:e}function d(e){if("idle"!==H)throw Error("check() is only allowed in idle status");return D=e,a("check"),r(_).then(function(e){if(!e)return a("idle"),null;A={},S={},j=e.c,v=e.h,a("prepare");var t=new Promise(function(e,t){g={resolve:e,reject:t}});y={};return u(0),"prepare"===H&&0===T&&0===E&&l(),t})}function s(e,t){if(j[e]&&A[e]){A[e]=!1;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(y[n]=t[n]);0==--E&&0===T&&l()}}function u(e){j[e]?(A[e]=!0,E++,n(e)):S[e]=!0}function l(){a("ready");var e=g;if(g=null,e)if(D)Promise.resolve().then(function(){return p(D)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var n in y)Object.prototype.hasOwnProperty.call(y,n)&&t.push(c(n));e.resolve(t)}}function p(n){function r(e,t){for(var n=0;t.length>n;n++){var r=t[n];0>e.indexOf(r)&&e.push(r)}}if("ready"!==H)throw Error("apply() is only allowed in ready status");n=n||{};var o,i,d,s,u,l={},p=[],h={},m=function(){console.warn("[HMR] unexpected require("+D.moduleId+") to disposed module")};for(var g in y)if(Object.prototype.hasOwnProperty.call(y,g)){u=c(g);var D;D=y[g]?function(e){for(var t=[e],n={},o=t.slice().map(function(e){return{chain:[e],id:e}});o.length>0;){var i=o.pop(),a=i.id,c=i.chain;if((s=k[a])&&!s.hot._selfAccepted){if(s.hot._selfDeclined)return{type:"self-declined",chain:c,moduleId:a};if(s.hot._main)return{type:"unaccepted",chain:c,moduleId:a};for(var d=0;s.parents.length>d;d++){var u=s.parents[d],l=k[u];if(l){if(l.hot._declinedDependencies[a])return{type:"declined",chain:c.concat([u]),moduleId:a,parentId:u};0>t.indexOf(u)&&(l.hot._acceptedDependencies[a]?(n[u]||(n[u]=[]),r(n[u],[a])):(delete n[u],t.push(u),o.push({chain:c.concat([u]),id:u})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}(u):{type:"disposed",moduleId:g};var _=!1,I=!1,x=!1,E="";switch(D.chain&&(E="\nUpdate propagation: "+D.chain.join(" -> ")),D.type){case"self-declined":n.onDeclined&&n.onDeclined(D),n.ignoreDeclined||(_=Error("Aborted because of self decline: "+D.moduleId+E));break;case"declined":n.onDeclined&&n.onDeclined(D),n.ignoreDeclined||(_=Error("Aborted because of declined dependency: "+D.moduleId+" in "+D.parentId+E));break;case"unaccepted":n.onUnaccepted&&n.onUnaccepted(D),n.ignoreUnaccepted||(_=Error("Aborted because "+u+" is not accepted"+E));break;case"accepted":n.onAccepted&&n.onAccepted(D),I=!0;break;case"disposed":n.onDisposed&&n.onDisposed(D),x=!0;break;default:throw Error("Unexception type "+D.type)}if(_)return a("abort"),Promise.reject(_);if(I){h[u]=y[u],r(p,D.outdatedModules);for(u in D.outdatedDependencies)Object.prototype.hasOwnProperty.call(D.outdatedDependencies,u)&&(l[u]||(l[u]=[]),r(l[u],D.outdatedDependencies[u]))}x&&(r(p,[D.moduleId]),h[u]=m)}var T=[];for(i=0;p.length>i;i++)u=p[i],k[u]&&k[u].hot._selfAccepted&&T.push({module:u,errorHandler:k[u].hot._selfAccepted});a("dispose"),Object.keys(j).forEach(function(e){!1===j[e]&&t(e)});for(var S,A=p.slice();A.length>0;)if(u=A.pop(),s=k[u]){var P={},z=s.hot._disposeHandlers;for(d=0;z.length>d;d++)(o=z[d])(P);for(O[u]=P,s.hot.active=!1,delete k[u],delete l[u],d=0;s.children.length>d;d++){var C=k[s.children[d]];C&&(0>(S=C.parents.indexOf(u))||C.parents.splice(S,1))}}var M,q;for(u in l)if(Object.prototype.hasOwnProperty.call(l,u)&&(s=k[u]))for(q=l[u],d=0;q.length>d;d++)M=q[d],0>(S=s.children.indexOf(M))||s.children.splice(S,1);a("apply"),b=v;for(u in h)Object.prototype.hasOwnProperty.call(h,u)&&(e[u]=h[u]);var L=null;for(u in l)if(Object.prototype.hasOwnProperty.call(l,u)&&(s=k[u])){q=l[u];var N=[];for(i=0;q.length>i;i++)if(M=q[i],o=s.hot._acceptedDependencies[M]){if(N.indexOf(o)>=0)continue;N.push(o)}for(i=0;N.length>i;i++){o=N[i];try{o(q)}catch(e){n.onErrored&&n.onErrored({type:"accept-errored",moduleId:u,dependencyId:q[i],error:e}),n.ignoreErrored||L||(L=e)}}}for(i=0;T.length>i;i++){var R=T[i];u=R.module,w=[u];try{f(u)}catch(e){if("function"==typeof R.errorHandler)try{R.errorHandler(e)}catch(t){n.onErrored&&n.onErrored({type:"self-accept-error-handler-errored",moduleId:u,error:t,orginalError:e,originalError:e}),n.ignoreErrored||L||(L=t),L||(L=e)}else n.onErrored&&n.onErrored({type:"self-accept-errored",moduleId:u,error:e}),n.ignoreErrored||L||(L=e)}}return L?(a("fail"),Promise.reject(L)):(a("idle"),new Promise(function(e){e(p)}))}function f(t){if(k[t])return k[t].exports;var n=k[t]={i:t,l:!1,exports:{},hot:i(t),parents:(I=w,w=[],I),children:[]};return e[t].call(n.exports,n,n.exports,o(t)),n.l=!0,n.exports}var h=window.webpackHotUpdatethd_targeted_merchandise;window.webpackHotUpdatethd_targeted_merchandise=function(e,t){s(e,t),h&&h(e,t)};var m,g,y,v,D=!0,b="e280afc4ba0ab64e3a5a",_=1e4,O={},w=[],I=[],x=[],H="idle",E=0,T=0,S={},A={},j={},k={};return f.m=e,f.c=k,f.d=function(e,t,n){f.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},f.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return f.d(t,"a",t),t},f.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},f.p="",f.h=function(){return b},o(1)(f.s=1)}([function(t,n){t.exports=e},function(e,t,n){"use strict";var r=n(2),o=(n(0),n(3)),i=o.get();i=i||window.digitalData||{};var a=function(e){return"A"===e.nodeName&&-1!==e.className.indexOf("bttn")},c=function(e){return"IMG"===e.nodeName},d=function(e){return e.some(a)?"btn":e.some(c)?"img":"txt"},s=function(e){var t=e.filter(function(e){return"bttn__content"===e.className}).map(function(e){return e.innerText});return t.length>0?t[0]:""},u=function(e){var t=e.filter(function(e){return"IMG"===e.nodeName}).map(function(e){return e.alt});return t.length>0?t[0]:""},l=function(e){var t=e.filter(function(e){return"A"===e.nodeName}).map(function(e){return e.innerText});return t.length>0?t[0]:""},p={btn:s,img:u,txt:l},f=function(e){i&&(i.content=i.content||{},i.content.widgets=i.content.widgets||[],i.content.widgets.push({id:e,name:"targeted merchandise",templates:"local"}))},h=function(e,t,n){var r=event.path||event.composedPath&&event.composedPath(),o=r?d(r):"",a=o?p[o](r):"",c={action:a,id:e,name:"targeted merchandise",templates:"local",component:o,campaign:t+"_"+n},s={};s.category={primaryCategory:"stash"},s.eventInfo={eventName:"content module click"},s.stash={pageType:i&&i.page&&i.page.pageInfo&&i.page.pageInfo.pageType},s.stash.content&&s.stash.content.widgets?s.stash.content.widgets.push(c):s.stash.content={widgets:[c]},void 0!==i&&i.hasOwnProperty("event")&&i.event.push(s)},m=function(e,t,n,r,o){return!!o&&e.some(function(e){return e===o.state})||t.some(function(e){return e.city.toLowerCase()===o.city&&e.state.toUpperCase()===o.state})||n.some(function(e){return e===o.zipcode})||r.some(function(e){return e===o.storeId})},g=function(e,t){var n=e.getAttribute(t);return n?n.split(","):[]},y=function(e){return{campaignName:e.getAttribute("data-campaign-name"),launchDate:e.getAttribute("data-launch-date"),states:g(e,"data-states"),cities:g(e,"data-cities").filter(function(e){return 2===e.split("|").length}).map(function(e){return{city:e.split("|")[0],state:e.split("|")[1]}}),zipcodes:g(e,"data-zipcodes"),storeIds:g(e,"data-storeids"),exclude:"true"==e.getAttribute("data-exclude-stores")}},v=function(e,t){return e?!t:t},D=function(e){return e.classList.remove("hide")},b=function(){var e=r.getLocalizedStore();!!e&&Array.prototype.forEach.call(document.querySelectorAll(".targetedMerchandise"),function(t){var n=y(t),r=m(n.states,n.cities,n.zipcodes,n.storeIds,e);if(r=v(n.exclude,r),r&&D(t),r){f(t.id);var o=document.querySelectorAll("#"+t.id+" .content a");if(o)for(var i=0;o.length>i;i++)o[i].addEventListener("click",function(){h(t.id,n.campaignName,n.launchDate)},!1)}})};e.exports={init:function(){r.status.isLocalized()?b():r.localize().then(b)},test:{renderTargetedMerchandise:b,stashAnalyticsOnClick:h,updateAnalyticsOnPageLoad:f,digitalData:i}}},function(e,n){e.exports=t},function(e,t,n){var r,o,i=i||{};i.event=i.event||[],i.legacy=i.legacy||{},function(i,a){i.THD=i.THD||{},i.THD.Analytics=i.THD.Analytics||{},r=[n(4),n(0)],void 0!==(o=function(e,t){return a(e,t,i)}.apply(t,r))&&(e.exports=o)}(this,function(e,t,n){function r(e){return e?decodeURIComponent(n.document.cookie.replace(RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:null}function o(e){var t,n,o=r(e.name);if(!o)return null;if(e.hasOwnProperty("delimiter")){for(o=o?o.split(e.delimiter):"",t=o.length,n=t-1;n>=0;n-=1)if(-1!==o[n].indexOf(e.crumb))return o[n].split("=")[1];return null}return o}function i(e){var t,o,i=n.document.cookie.split("; "),a=i.length;for(t=a-1;t>=0;t-=1)if(0===i[t].indexOf(e)&&(o=i[t].split("=")[0],o=r(o)))return o.split(",")[0]}function a(){var e="";return"undefined"!=typeof THD_GLOBAL&&"mobile"===THD_GLOBAL.channel&&(e="mobile"),""===e&&(e=/ipad/i.test(n.navigator.userAgent)?"tablet":"desktop"),e}function c(){return!!t.readCookie("THD_USER_SESSION")||"1"===t.readCookie("THD_USERSTATUS")&&t.readCookie("THD_USERNAME")}return n.THD=n.THD||{},n.THD.Analytics.setStorage=function(e){try{n.localStorage.setItem("localizationMethod",e)}catch(e){return}},{init:function(){t.cookieManager||t.initializeCookieManager();var d,s=n.digitalData;window.THD.Analytics._DDO=s,s.site={experienceType:a(),siteId:"",betaSite:function(){var e=o({name:"HD_DC"});return"origin"===e?"prod":"beta"===e?"beta":""}()},s.setStorage=function(e){try{n.localStorage.setItem("localizationMethod",e),n.digitalData.user.localization.method=e}catch(e){return}},s.user={profile:{authenticationStatus:c()?"authenticated":"guest",profileInfo:{profileID:t.getSVOCID()}},localization:{storeNumber:function(){var e=o({name:"THD_PERSIST",crumb:"C4=",delimiter:"+"});return e||"not localized"}(),storeState:function(){var e=o({name:"THD_PERSIST",crumb:"C4=",delimiter:":;"});return e&&'""'!==e[0]&&(e=e.split("+")[1],e=e.substr(e.length-2)),e}(),gpsPermission:function(){var e=r("THD_GEOLOCALIZED");return e="false"===e||""===e||"undefined"===e?"gps access denied":"gps access granted"}(),storeZip:o({name:"THD_PERSIST",crumb:"C24=",delimiter:":;"}),method:n.localStorage.getItem("localizationMethod")}};var u=i("WC_USERACTIVITY_");return s.legacy.profileID=u||"",d=r("THD_IS_INSTORE"),"authenticated"===s.user.profile.authenticationStatus&&(s.user.localization.method="my account sign-in",n.THD.Analytics.setStorage("my account sign-in")),d&&(s.user.localization.method="in store access",n.THD.Analytics.setStorage("in store access")),e(n.document).trigger("globalDDOready",s),s},get:function(){return n.digitalData}}})},function(e,t){e.exports=n}])});
//# sourceMappingURL=main.amd.js.map